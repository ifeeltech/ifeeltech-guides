<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  {% seo %}
  
  {% if page.canonical_url %}
  <link rel="canonical" href="{{ page.canonical_url }}">
  {% endif %}
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="{{ page.url | absolute_url }}">
  <meta property="og:title" content="{{ page.title }} | iFeeltech Guides">
  <meta property="og:description" content="{{ page.description | default: site.description }}">
  {% if page.featured_image %}
  <meta property="og:image" content="{{ page.featured_image }}">
  {% endif %}
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="{{ page.url | absolute_url }}">
  <meta property="twitter:title" content="{{ page.title }} | iFeeltech Guides">
  <meta property="twitter:description" content="{{ page.description | default: site.description }}">
  {% if page.featured_image %}
  <meta property="twitter:image" content="{{ page.featured_image }}">
  {% endif %}
  
  <!-- Schema.org markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "{{ page.title }}",
    "description": "{{ page.description | default: site.description }}",
    "author": {
      "@type": "Organization",
      "name": "iFeeltech",
      "url": "https://ifeeltech.com"
    },
    "publisher": {
      "@type": "Organization",
      "name": "iFeeltech",
      "url": "https://ifeeltech.com"
    },
    "datePublished": "{{ page.date | date_to_xmlschema }}",
    "dateModified": "{{ page.date | date_to_xmlschema }}",
    {% if page.featured_image %}
    "image": "{{ page.featured_image }}",
    {% endif %}
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ page.url | absolute_url }}"
    }
  }
  </script>
  
  <link rel="stylesheet" href="{{ '/assets/style.css' | relative_url }}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Reading Progress Bar -->
  <div class="reading-progress" id="reading-progress"></div>
  
  <header>
    <div class="header-container">
      <nav class="navbar" role="navigation" aria-label="Main navigation">
        <!-- Logo -->
        <a href="{{ '/' | relative_url }}" class="logo" aria-label="iFeeltech Guides Home">
          <svg class="logo-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="32" height="32" rx="8" fill="url(#logo-gradient)"/>
            <path d="M16 8L22 12V20L16 24L10 20V12L16 8Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="16" cy="16" r="3" fill="white"/>
            <defs>
              <linearGradient id="logo-gradient" x1="0" y1="0" x2="32" y2="32" gradientUnits="userSpaceOnUse">
                <stop stop-color="#ff7441"/>
                <stop offset="1" stop-color="#ff8c5a"/>
              </linearGradient>
            </defs>
          </svg>
          <span class="logo-text">iFeeltech <span class="logo-guides">Guides</span></span>
        </a>
        
        <!-- Desktop Navigation -->
        <div class="nav-menu" id="nav-menu">
          <a href="{{ '/' | relative_url }}" class="nav-link">All Guides</a>
          <div class="nav-dropdown">
            <button class="nav-link dropdown-toggle" aria-expanded="false" aria-haspopup="true">
              Categories
              <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 4.5L6 7.5L9 4.5"/>
              </svg>
            </button>
            <div class="dropdown-menu">
              <a href="{{ '/' | relative_url }}?tag=cybersecurity" class="dropdown-item">Cybersecurity</a>
              <a href="{{ '/' | relative_url }}?tag=networking" class="dropdown-item">Networking</a>
              <a href="{{ '/' | relative_url }}?tag=cloud" class="dropdown-item">Cloud & Infrastructure</a>
              <a href="{{ '/' | relative_url }}?tag=software" class="dropdown-item">Software & Tools</a>
              <a href="{{ '/' | relative_url }}?tag=business" class="dropdown-item">Business IT</a>
            </div>
          </div>
          <a href="https://ifeeltech.com" class="nav-link">Main Site</a>
        </div>
        
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </nav>
    </div>
  </header>
  
  <main class="content">
    {% if page.featured_image %}
    <div class="featured-image">
      <img src="{{ page.featured_image }}" alt="{{ page.title }}" loading="lazy">
      {% if page.image_credit %}
      <p class="image-credit">Photo: {{ page.image_credit }}</p>
      {% endif %}
    </div>
    {% endif %}
    
    <article>
      <h1>{{ page.title }}</h1>
      {% if page.date %}
      <div class="meta">
        <span class="date">{{ page.date | date: "%B %d, %Y" }}</span>
        <span class="reading-time">{{ content | number_of_words | divided_by: 200 }} min read</span>
        {% if page.tags %}
        <div class="tags">
          {% for tag in page.tags %}
          <span class="tag">#{{ tag }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </div>
      {% endif %}
      
      <div class="article-content">
        {{ content }}
      </div>
      
      <!-- Social Share Buttons -->
      {% if page.date %}
      <div class="social-share">
        <span class="social-share-label">Share:</span>
        <div class="social-share-buttons">
          <a href="#" class="share-button twitter" id="share-twitter" title="Share on Twitter" aria-label="Share on Twitter">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </a>
          <a href="#" class="share-button linkedin" id="share-linkedin" title="Share on LinkedIn" aria-label="Share on LinkedIn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </a>
          <a href="#" class="share-button email" id="share-email" title="Share via Email" aria-label="Share via Email">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
          </a>
          <button class="share-button copy" id="share-copy" title="Copy Link" aria-label="Copy Link">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
          </button>
        </div>
      </div>
      {% endif %}
    </article>
    
    <!-- Related Articles -->
    {% if page.layout == 'default' and page.date %}
    <aside class="related-articles">
      <h3>Related Articles</h3>
      <div class="related-articles-grid">
        {% assign related_posts = site.posts | where_exp: "post", "post.url != page.url" | sample: 3 %}
        {% for post in related_posts limit:3 %}
        <div class="related-article-card">
          <h4><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h4>
          <p>{{ post.description | truncate: 100 }}</p>
        </div>
        {% endfor %}
      </div>
    </aside>
    {% endif %}
    
    {% if page.layout == 'default' and page.date %}
    <aside class="related-cta">
      <h3>Need Expert Guidance?</h3>
      <p>Our team at iFeeltech specializes in practical cybersecurity solutions for small and medium businesses.</p>
      <a href="https://ifeeltech.com/contact" class="cta-button">Get in Touch</a>
    </aside>
    {% endif %}
  </main>
  
  <footer>
    <div class="footer-container">
      <p>© {{ "now" | date: "%Y" }} iFeeltech — <a href="https://ifeeltech.com">ifeeltech.com</a></p>
      <p class="footer-tagline">Practical IT solutions for growing businesses</p>
    </div>
  </footer>
  
  <!-- Floating TOC (only on article pages) -->
  {% if page.date %}
  <button class="toc-toggle" id="toc-toggle" aria-label="Toggle Table of Contents" style="display: none;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
      <line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/>
    </svg>
  </button>
  
  <aside class="table-of-contents" id="table-of-contents">
    <h4>On This Page</h4>
    <ul id="toc-list"></ul>
  </aside>
  {% endif %}
  
  <script>
    // Reading Progress Bar
    function updateReadingProgress() {
      const progressBar = document.getElementById('reading-progress');
      if (!progressBar) return;
      
      const windowHeight = window.innerHeight;
      const documentHeight = document.documentElement.scrollHeight - windowHeight;
      const scrolled = window.scrollY;
      const progress = (scrolled / documentHeight) * 100;
      
      progressBar.style.width = progress + '%';
    }
    
    // Table of Contents Generation
    function generateTableOfContents() {
      const toc = document.getElementById('table-of-contents');
      const tocList = document.getElementById('toc-list');
      const tocToggle = document.getElementById('toc-toggle');
      const articleContent = document.querySelector('.article-content');
      
      if (!toc || !tocList || !articleContent) return;
      
      const headings = articleContent.querySelectorAll('h2, h3');
      
      if (headings.length === 0) {
        return; // Don't show TOC if no headings
      }
      
      // Show TOC button since we have headings
      if (tocToggle) {
        tocToggle.style.display = 'flex';
      }
      
      headings.forEach((heading, index) => {
        // Add ID to heading if it doesn't have one
        if (!heading.id) {
          heading.id = 'heading-' + index;
        }
        
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = '#' + heading.id;
        a.textContent = heading.textContent;
        a.style.paddingLeft = heading.tagName === 'H3' ? '1.5rem' : '0.75rem';
        
        a.addEventListener('click', (e) => {
          e.preventDefault();
          heading.scrollIntoView({ behavior: 'smooth', block: 'start' });
          history.pushState(null, null, '#' + heading.id);
          // Close TOC after clicking
          toc.classList.remove('visible');
          if (tocToggle) tocToggle.classList.remove('active');
        });
        
        li.appendChild(a);
        tocList.appendChild(li);
      });
    }
    
    // TOC Toggle
    function initTocToggle() {
      const tocToggle = document.getElementById('toc-toggle');
      const toc = document.getElementById('table-of-contents');
      
      if (!tocToggle || !toc) return;
      
      tocToggle.addEventListener('click', function() {
        toc.classList.toggle('visible');
        tocToggle.classList.toggle('active');
      });
      
      // Close TOC when clicking outside
      document.addEventListener('click', function(e) {
        if (!toc.contains(e.target) && !tocToggle.contains(e.target)) {
          toc.classList.remove('visible');
          tocToggle.classList.remove('active');
        }
      });
    }
    
    // Highlight active TOC item on scroll
    function highlightActiveTocItem() {
      const headings = document.querySelectorAll('.article-content h2, .article-content h3');
      const tocLinks = document.querySelectorAll('.table-of-contents a');
      
      if (headings.length === 0 || tocLinks.length === 0) return;
      
      let currentActive = null;
      
      headings.forEach((heading) => {
        const rect = heading.getBoundingClientRect();
        if (rect.top <= 150 && rect.top >= -50) {
          currentActive = heading.id;
        }
      });
      
      tocLinks.forEach((link) => {
        link.classList.remove('active');
        if (currentActive && link.getAttribute('href') === '#' + currentActive) {
          link.classList.add('active');
        }
      });
    }
    
    // Social Share Functions
    function initSocialShare() {
      const pageUrl = encodeURIComponent(window.location.href);
      const pageTitle = encodeURIComponent(document.title);
      
      // Twitter
      const twitterBtn = document.getElementById('share-twitter');
      if (twitterBtn) {
        twitterBtn.href = `https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`;
        twitterBtn.target = '_blank';
        twitterBtn.rel = 'noopener noreferrer';
      }
      
      // LinkedIn
      const linkedinBtn = document.getElementById('share-linkedin');
      if (linkedinBtn) {
        linkedinBtn.href = `https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`;
        linkedinBtn.target = '_blank';
        linkedinBtn.rel = 'noopener noreferrer';
      }
      
      // Email
      const emailBtn = document.getElementById('share-email');
      if (emailBtn) {
        emailBtn.href = `mailto:?subject=${pageTitle}&body=I thought you might find this interesting: ${pageUrl}`;
      }
      
      // Copy Link
      const copyBtn = document.getElementById('share-copy');
      if (copyBtn) {
        copyBtn.addEventListener('click', async function(e) {
          e.preventDefault();
          try {
            await navigator.clipboard.writeText(window.location.href);
            copyBtn.classList.add('copied');
            setTimeout(() => {
              copyBtn.classList.remove('copied');
            }, 2000);
          } catch (err) {
            console.error('Failed to copy:', err);
          }
        });
      }
    }
    
    // Mobile Menu Toggle
    function initMobileMenu() {
      const mobileToggle = document.getElementById('mobile-menu-toggle');
      const navMenu = document.getElementById('nav-menu');
      
      if (!mobileToggle || !navMenu) return;
      
      mobileToggle.addEventListener('click', function() {
        const isExpanded = mobileToggle.getAttribute('aria-expanded') === 'true';
        mobileToggle.setAttribute('aria-expanded', !isExpanded);
        navMenu.classList.toggle('active');
      });
      
      // Close mobile menu when clicking outside
      document.addEventListener('click', function(e) {
        if (!mobileToggle.contains(e.target) && !navMenu.contains(e.target)) {
          mobileToggle.setAttribute('aria-expanded', 'false');
          navMenu.classList.remove('active');
        }
      });
    }
    
    // Dropdown Toggle (for mobile)
    function initDropdowns() {
      const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
      
      dropdownToggles.forEach(toggle => {
        toggle.addEventListener('click', function(e) {
          e.preventDefault();
          const isExpanded = toggle.getAttribute('aria-expanded') === 'true';
          toggle.setAttribute('aria-expanded', !isExpanded);
        });
      });
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      initMobileMenu();
      initDropdowns();
      generateTableOfContents();
      initTocToggle();
      updateReadingProgress();
      highlightActiveTocItem();
      initSocialShare();
    });
    
    // Update on scroll
    let scrollTimeout;
    window.addEventListener('scroll', function() {
      updateReadingProgress();
      
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(highlightActiveTocItem, 50);
    });
  </script>
</body>
</html>
